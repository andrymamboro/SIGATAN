{"version":3,"file":"Login-Bi1LxGmg.js","sources":["../../Pages/Login.jsx"],"sourcesContent":["import React, { useState, forwardRef } from 'react';\r\nimport { useNavigate } from 'react-router-dom';\r\nimport { supabase } from '../api/db';\r\nimport { Map, Lock, User } from 'lucide-react';\r\nimport { toast } from 'sonner';\r\nimport { getCurrentUser } from '../api/authUser';\r\n\r\n// UI Components\r\nconst Card = forwardRef(({ className, children, ...props }, ref) => (\r\n  <div ref={ref} className={`rounded-lg border bg-card text-card-foreground shadow-sm ${className || ''}`} {...props}>\r\n    {children}\r\n  </div>\r\n));\r\nCard.displayName = \"Card\";\r\n\r\nconst CardHeader = forwardRef(({ className, children, ...props }, ref) => (\r\n  <div ref={ref} className={`flex flex-col space-y-1.5 p-6 ${className || ''}`} {...props}>\r\n    {children}\r\n  </div>\r\n));\r\nCardHeader.displayName = \"CardHeader\";\r\n\r\nconst CardTitle = forwardRef(({ className, children, ...props }, ref) => (\r\n  <h3 ref={ref} className={`text-2xl font-semibold leading-none tracking-tight ${className || ''}`} {...props}>\r\n    {children}\r\n  </h3>\r\n));\r\nCardTitle.displayName = \"CardTitle\";\r\n\r\nconst CardDescription = forwardRef(({ className, children, ...props }, ref) => (\r\n  <p ref={ref} className={`text-sm text-muted-foreground ${className || ''}`} {...props}>\r\n    {children}\r\n  </p>\r\n));\r\nCardDescription.displayName = \"CardDescription\";\r\n\r\nconst CardContent = forwardRef(({ className, children, ...props }, ref) => (\r\n  <div ref={ref} className={`p-6 pt-0 ${className || ''}`} {...props}>\r\n    {children}\r\n  </div>\r\n));\r\nCardContent.displayName = \"CardContent\";\r\n\r\nconst Input = forwardRef(({ className, ...props }, ref) => (\r\n  <input\r\n    ref={ref}\r\n    className={`flex h-10 w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background file:border-0 file:bg-transparent file:text-sm file:font-medium placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 ${className || ''}`}\r\n    {...props}\r\n  />\r\n));\r\nInput.displayName = \"Input\";\r\n\r\nconst Button = forwardRef(({ className, children, ...props }, ref) => (\r\n  <button\r\n    ref={ref}\r\n    className={`inline-flex items-center justify-center whitespace-nowrap rounded-md text-sm font-medium ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 h-10 px-4 py-2 ${className || ''}`}\r\n    {...props}\r\n  >\r\n    {children}\r\n  </button>\r\n));\r\nButton.displayName = \"Button\";\r\n\r\nconst Label = forwardRef(({ className, ...props }, ref) => (\r\n  <label\r\n    ref={ref}\r\n    className={`text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70 ${className || ''}`}\r\n    {...props}\r\n  />\r\n));\r\nLabel.displayName = \"Label\";\r\n\r\nexport default function Login() {\r\n  const [username, setUsername] = useState('');\r\n  const [password, setPassword] = useState('');\r\n  const [loading, setLoading] = useState(false);\r\n  const navigate = useNavigate();\r\n\r\n  // Login ke Supabase Auth dan cek user gabungan\r\n  const handleLogin = async (e) => {\r\n    e.preventDefault();\r\n    if (!username || !password) {\r\n      toast.error('Username dan password harus diisi');\r\n      return;\r\n    }\r\n    setLoading(true);\r\n    try {\r\n      // Cek apakah input username berupa email atau username\r\n      let email = username;\r\n      if (!username.includes('@')) {\r\n        // Cari email dari tabel users jika input bukan email\r\n        const { data: userDb, error: userDbError } = await supabase\r\n          .from('users')\r\n          .select('email')\r\n          .or(`username.eq.${username},no_hp.eq.${username}`)\r\n          .single();\r\n        if (userDbError || !userDb) {\r\n          toast.error('Username/email tidak ditemukan');\r\n          setLoading(false);\r\n          return;\r\n        }\r\n        email = userDb.email;\r\n      }\r\n      // Login ke Supabase Auth\r\n      const { error: authError } = await supabase.auth.signInWithPassword({\r\n        email,\r\n        password\r\n      });\r\n      if (authError) {\r\n        toast.error('Login gagal: ' + authError.message);\r\n        setLoading(false);\r\n        return;\r\n      }\r\n      // Ambil user gabungan\r\n      const userGabungan = await getCurrentUser();\r\n      if (!userGabungan) {\r\n        toast.error('User tidak ditemukan di database');\r\n        setLoading(false);\r\n        return;\r\n      }\r\n      localStorage.setItem('user', JSON.stringify(userGabungan));\r\n      toast.success('Login berhasil!');\r\n      setTimeout(() => {\r\n        navigate('/dashboard');\r\n      }, 500);\r\n    } catch (error) {\r\n      toast.error('Terjadi kesalahan saat login');\r\n      console.error('Login error:', error);\r\n    } finally {\r\n      setLoading(false);\r\n    }\r\n  };\r\n\r\n  return (\r\n    <div className=\"min-h-screen bg-gradient-to-r from-blue-900 via-blue-800 to-blue-900 flex items-center justify-center p-4 relative overflow-hidden\">\r\n      {/* Decorative elements */}\r\n      <div className=\"absolute inset-0 overflow-hidden\">\r\n        <div className=\"absolute -top-40 -right-40 w-80 h-80 bg-blue-500/20 rounded-full blur-3xl\"></div>\r\n        <div className=\"absolute -bottom-40 -left-40 w-80 h-80 bg-slate-500/20 rounded-full blur-3xl\"></div>\r\n      </div>\r\n      \r\n      <div className=\"w-full max-w-md relative z-10\">\r\n        {/* Logo/Header */}\r\n        <div className=\"text-center mb-2\">\r\n          <div className=\"inline-flex items-center justify-center\" >\r\n            <img \r\n              src=\"/Components/img/logo app.png\" \r\n              alt=\"Logo SIGATAN\" \r\n              className=\"w-40 h-40 object-contain drop-shadow-2xl\"\r\n            />\r\n          </div>\r\n          <h1 className=\"text-2xl font-bold text-white mb-2 drop-shadow-lg\" style={{ marginTop: '-10px' }}>\r\n            SIGATAN\r\n          </h1>\r\n          <p className=\"text-blue-100 text-lg\">\r\n            Sistem Informasi Geospasial Pertanahan\r\n          </p>\r\n        </div>\r\n\r\n        {/* Login Card */}\r\n        <Card className=\"border-0 shadow-2xl backdrop-blur-sm bg-white/95\">\r\n          <CardHeader className=\"space-y-1 pb-6 pt-8\">\r\n            <CardTitle className=\"text-2xl text-center text-slate-800 font-bold\">Selamat Datang</CardTitle>\r\n            <CardDescription className=\"text-center text-slate-500\">\r\n              Silakan masuk dengan akun Anda\r\n            </CardDescription>\r\n          </CardHeader>\r\n          <CardContent className=\"px-8 pb-8\">\r\n            <form onSubmit={handleLogin} className=\"space-y-5\">\r\n              <div className=\"space-y-2\">\r\n                <Label htmlFor=\"username\" className=\"text-slate-700 font-semibold\">Username</Label>\r\n                <div className=\"relative\">\r\n                  <User className=\"absolute left-3 top-3.5 h-5 w-5 text-blue-500\" />\r\n                  <Input\r\n                    id=\"username\"\r\n                    type=\"text\"\r\n                    placeholder=\"Masukkan username\"\r\n                    value={username}\r\n                    onChange={(e) => setUsername(e.target.value)}\r\n                    className=\"pl-11 h-12 border-slate-300 focus:border-blue-500 focus:ring-blue-500\"\r\n                    required\r\n                    disabled={loading}\r\n                  />\r\n                </div>\r\n              </div>\r\n\r\n              <div className=\"space-y-2\">\r\n                <Label htmlFor=\"password\" className=\"text-slate-700 font-semibold\">Password</Label>\r\n                <div className=\"relative\">\r\n                  <Lock className=\"absolute left-3 top-3.5 h-5 w-5 text-blue-500\" />\r\n                  <Input\r\n                    id=\"password\"\r\n                    type=\"password\"\r\n                    placeholder=\"Masukkan password\"\r\n                    value={password}\r\n                    onChange={(e) => setPassword(e.target.value)}\r\n                    className=\"pl-11 h-12 border-slate-300 focus:border-blue-500 focus:ring-blue-500\"\r\n                    required\r\n                    disabled={loading}\r\n                  />\r\n                </div>\r\n              </div>\r\n\r\n              <Button\r\n                type=\"submit\"\r\n                className=\"w-full bg-gradient-to-r from-blue-600 to-blue-700 hover:from-blue-700 hover:to-blue-800 h-12 text-base font-semibold shadow-lg hover:shadow-xl transition-all duration-200\"\r\n                disabled={loading}\r\n              >\r\n                {loading ? (\r\n                  <div className=\"flex items-center gap-2\">\r\n                    <div className=\"animate-spin rounded-full h-5 w-5 border-b-2 border-white\"></div>\r\n                    <span>Memproses...</span>\r\n                  </div>\r\n                ) : (\r\n                  'Masuk'\r\n                )}\r\n              </Button>\r\n            </form>\r\n\r\n            <div className=\"mt-6 text-center text-sm text-slate-500\">\r\n              <p className=\"flex items-center justify-center gap-2\">\r\n                <Lock className=\"w-4 h-4\" />\r\n                Login aman dan terenkripsi\r\n              </p>\r\n            </div>\r\n          </CardContent>\r\n        </Card>\r\n\r\n        {/* Footer */}\r\n        <div className=\"text-center mt-6 text-sm text-slate-500\">\r\n          <p>&copy; 2025 andrimamboro web development. All rights reserved.</p>\r\n        </div>\r\n      </div>\r\n    </div>\r\n  );\r\n}\r\n"],"names":["Card","forwardRef","className","children","props","ref","CardHeader","CardTitle","CardDescription","CardContent","Input","jsx","Button","Label","Login","username","setUsername","useState","password","setPassword","loading","setLoading","navigate","useNavigate","handleLogin","e","toast","email","userDb","userDbError","supabase","authError","userGabungan","getCurrentUser","error","jsxs","User","Lock"],"mappings":"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"}