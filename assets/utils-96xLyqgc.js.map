{"version":3,"file":"utils-96xLyqgc.js","sources":["../../lib/utilsUser.jsx","../../Components/maps/utils.js"],"sourcesContent":["import { useState, useEffect } from 'react';\r\nimport { useQuery } from '@tanstack/react-query';\r\nimport { supabase } from '@/api/db';\r\nimport { getCurrentUser } from '@/api/authUser';\r\n\r\n// Ambil user aktif\r\nexport function useCurrentUser() {\r\n  const [user, setUser] = useState(null);\r\n  useEffect(() => {\r\n    const fetchUser = async () => {\r\n      const user = await getCurrentUser();\r\n      setUser(user);\r\n    };\r\n    fetchUser();\r\n  }, []);\r\n  return user;\r\n}\r\n\r\n// Ambil data tanah sesuai role user\r\nexport function useTanahList(user) {\r\n  return useQuery({\r\n    queryKey: ['tanah-peta', user?.kecamatan, user?.kelurahan, user?.role, user?.nik],\r\n    queryFn: async () => {\r\n      if (!user) return [];\r\n      let query = supabase.from('tanah').select('*');\r\n      if (user.role === 'super_admin') {\r\n        // ...tambahkan logic super_admin jika ada...\r\n      } else if (user.role === 'admin_kecamatan') {\r\n        query = query.eq('kecamatan', user.kecamatan);\r\n      } else if (user.role === 'admin_kelurahan') {\r\n        query = query.eq('kelurahan', user.kelurahan);\r\n      } else if (user.role === 'member') {\r\n        query = query.or(`nik_pemilik.eq.${user.nik},nik_penerima.eq.${user.nik}`);\r\n      } else {\r\n        return [];\r\n      }\r\n      const { data, error } = await query;\r\n      if (error) throw new Error(error.message);\r\n      return data || [];\r\n    },\r\n    enabled: !!user,\r\n  });\r\n}\r\n\r\n// Ambil data wilayah\r\nexport function useWilayahList() {\r\n  return useQuery({\r\n    queryKey: ['wilayah'],\r\n    queryFn: async () => {\r\n      const { data, error } = await supabase.from('wilayah').select('*');\r\n      if (error) throw new Error(error.message);\r\n      return data || [];\r\n    },\r\n  });\r\n}","// Utility: Mendapatkan warna background/fill polygon/polyline berdasarkan status\r\n// Catatan: Semua warna fill di bawah menggunakan alpha/transparansi (rgba) agar background polygon/polyline tidak menutupi peta sepenuhnya.\r\n\r\n// Contoh: fillColor={getPolygonFillColor(tanah.status)}\r\n// Utility: Daftar warna untuk keterangan/legend status marker & polygon\r\nexport const STATUS_COLOR_LEGEND = {\r\n  Proses:   { color: '#3b82f6', label: 'Biru' },\r\n  Selesai:  { color: '#EAB308', label: 'Kuning' },\r\n  Ditolak:  { color: '#ef4444', label: 'Merah' },\r\n  Hijau:    { color: '#22c55e', label: 'Hijau' },\r\n  Orange:   { color: '#f97316', label: 'Orange' },\r\n  Putih:    { color: '#ffffff', label: 'Putih' },\r\n  Ungu:     { color: '#a21caf', label: 'Ungu' },\r\n};\r\n\r\n// Contoh penggunaan:\r\n// STATUS_COLOR_LEGEND['Selesai'].color // => '#EAB308'\r\n// STATUS_COLOR_LEGEND['Selesai'].label // => 'Kuning'\r\n\r\n\r\n// Warna status untuk marker & polygon:\r\n// Proses   : #3b82f6 (biru)\r\n// Selesai  : #EAB308 (kuning)\r\n// Ditolak  : #ef4444 (merah)\r\n// Hijau    : #22c55e (green)\r\n// Orange   : #f97316 (orange)\r\n// Putih    : #ffffff (white)\r\n// Ungu     : #a21caf (purple)\r\n// Border polygon saat selected: #EAB308 (kuning)\r\n// Warna garis drawing polyline/polygon: #2563eb (biru-tua)\r\n\r\n// Utility to get color for drawing polyline/polygon (garis saat menggambar)\r\nexport function getDrawingLineColor() {    \r\n  return '#2563eb'; // biru-tua\r\n}\r\n\r\n// Utility to get polygon color and border color based on status and selection\r\nexport function getSelectedPolygonColor() {\r\n  return '#f97316'; // orange (atau ganti sesuai kebutuhan highlight)\r\n}\r\n\r\n// utils.js\r\nexport function getColors(status, isSelected) {\r\n  if (status === 'Selesai') return { color: 'transparent', borderColor: '#EAB308' };\r\n  if (status === 'Ditolak') return { color: 'transparent', borderColor: '#b91c1c' };\r\n  if (status === 'Proses') return { color: 'transparent', borderColor: '#1d4ed8' };\r\n  // Tambahkan status lain jika ada\r\n  return { color: 'transparent', borderColor: '#1d4ed8' }; // default biru\r\n}\r\n\r\nexport function getPolygonFillColor(status) {\r\n   if (status === 'Selesai') return { color: '#22c55e', borderColor: '#16a34a' };\r\n  if (status === 'Ditolak') return { color: '#ef4444', borderColor: '#b91c1c' };\r\n  if (status === 'Proses') return { color: '#3b82f6', borderColor: '#1d4ed8' };\r\n  // Tambahkan status lain jika ada\r\n  return { color: '#3b82f6', borderColor: '#1d4ed8' }; // default biru\r\n}\r\n\r\n// Utility for custom circle marker icon (status color, white border, responsive size)\r\n\r\n// import L from 'leaflet';\r\n\r\n// export function createCircleIcon(status, size = 16) {\r\n//   if (typeof window === 'undefined' || typeof document === 'undefined' || !L?.divIcon) {\r\n//     // Bisa return null, atau fallback ke icon default Leaflet\r\n//     return undefined;\r\n//   }\r\n//   // Ambil warna dari legend, fallback ke biru jika status tidak ada\r\n//   const color = STATUS_COLOR_LEGEND[status]?.color || '#3b82f6';\r\n//   return L.divIcon({\r\n//     html: `<div style=\"\r\n//       background:${color};\r\n//       border:2px solid #fff;\r\n//       width:${size}px;height:${size}px;\r\n//       border-radius:50%;\r\n//       box-shadow:0 0 4px #0002;\r\n//       \"></div>`,\r\n//     className: '',\r\n//     iconSize: [size, size],\r\n//     iconAnchor: [size / 2, size / 2],\r\n//     popupAnchor: [0, -size / 2]\r\n//   });\r\n\r\n\r\n\r\n\r\n\r\n"],"names":["useCurrentUser","user","setUser","useState","useEffect","async","getCurrentUser","fetchUser","useTanahList","useQuery","queryKey","kecamatan","kelurahan","role","nik","queryFn","query","supabase","from","select","eq","or","data","error","Error","message","enabled","getColors","status","isSelected","color","borderColor"],"mappings":"gIAMO,SAASA,IACd,MAAOC,EAAMC,GAAWC,EAAAA,SAAS,MAQjC,OAPAC,EAAAA,UAAU,KACUC,WAChB,MAAMJ,QAAaK,IACnBJ,EAAQD,IAEVM,IACC,IACIN,CACT,CAGO,SAASO,EAAaP,GAC3B,OAAOQ,EAAS,CACdC,SAAU,CAAC,aAAcT,GAAMU,UAAWV,GAAMW,UAAWX,GAAMY,KAAMZ,GAAMa,KAC7EC,QAASV,UACP,IAAKJ,EAAM,MAAO,GAClB,IAAIe,EAAQC,EAASC,KAAK,SAASC,OAAO,KAC1C,GAAkB,gBAAdlB,EAAKY,WAAwB,GAER,oBAAdZ,EAAKY,KACdG,EAAQA,EAAMI,GAAG,YAAanB,EAAKU,gBACrC,GAAyB,oBAAdV,EAAKY,KACdG,EAAQA,EAAMI,GAAG,YAAanB,EAAKW,eACrC,IAAyB,WAAdX,EAAKY,KAGd,MAAO,GAFPG,EAAQA,EAAMK,GAAG,kBAAkBpB,EAAKa,uBAAuBb,EAAKa,MAGtE,CACA,MAAMQ,KAAEA,EAAAC,MAAMA,SAAgBP,EAC9B,GAAIO,EAAO,MAAM,IAAIC,MAAMD,EAAME,SACjC,OAAOH,GAAQ,IAEjBI,UAAWzB,GAEf,CCAO,SAAS0B,EAAUC,EAAQC,GAChC,MAAe,YAAXD,EAA6B,CAAEE,MAAO,cAAeC,YAAa,WACvD,YAAXH,EAA6B,CAAEE,MAAO,cAAeC,YAAa,WACtC,CAAED,MAAO,cAAeC,YAAa,UAGvE"}