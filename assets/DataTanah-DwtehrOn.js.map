{"version":3,"file":"DataTanah-DwtehrOn.js","sources":["../../Pages/DataTanah.jsx"],"sourcesContent":["// Contoh: ambil data dari tabel 'Tanah'\r\n// const { data, error } = await supabase.from('Tanah').select('*');\r\nimport React, { useState, useEffect } from \"react\";\r\nimport { supabase } from \"@/api/supabaseClient\";\r\nimport { useQuery, useMutation, useQueryClient } from \"@tanstack/react-query\";\r\nimport { Card, CardContent, CardHeader, CardTitle } from \"@/components/ui/card\";\r\nimport { Button } from \"@/components/ui/button\";\r\nimport { Input } from \"@/components/ui/input\";\r\nimport {\r\n  Select,\r\n  SelectContent,\r\n  SelectItem,\r\n  SelectTrigger,\r\n  SelectValue,\r\n} from \"@/components/ui/select\";\r\nimport { Badge } from \"@/components/ui/badge\";\r\n\r\nimport {\r\n  AlertDialog,\r\n  AlertDialogAction,\r\n  AlertDialogCancel,\r\n  AlertDialogContent,\r\n  AlertDialogDescription,\r\n  AlertDialogFooter,\r\n  AlertDialogHeader,\r\n  AlertDialogTitle,\r\n} from \"@/components/ui/alert-dialog\";\r\nimport {\r\n  Dialog,\r\n  DialogContent,\r\n  DialogHeader,\r\n  DialogTitle,\r\n} from \"@/components/ui/dialog\";\r\nimport {\r\n  FileText,\r\n  Plus,\r\n  Search,\r\n  Eye,\r\n  Pencil,\r\n  Trash2,\r\n  MapPin,\r\n  User,\r\n  QrCode,\r\n  Printer,\r\n  Map,\r\n} from \"lucide-react\";\r\nimport { Link, useNavigate } from \"react-router-dom\";\r\nimport { createPageUrl } from \"@/utils\";\r\nimport { motion, AnimatePresence } from \"framer-motion\";\r\nimport { toast } from \"sonner\";\r\n\r\nexport default function DataTanah() {\r\n  // Pagination state\r\n  const [page, setPage] = useState(1);\r\n  const pageSize = 7;\r\n  const [user, setUser] = useState(null);\r\n  const [searchTerm, setSearchTerm] = useState(\"\");\r\n  const [filterStatus, setFilterStatus] = useState(\"all\");\r\n  const [deleteId, setDeleteId] = useState(null);\r\n  const [qrTanah, setQrTanah] = useState(null);\r\n  const navigate = useNavigate();\r\n\r\n  // Reset page to 1 when search/filter changes\r\n  useEffect(() => {\r\n    setPage(1);\r\n  }, [searchTerm, filterStatus]);\r\n\r\n  // Query tanahList from supabase\r\n  const {\r\n    data: tanahList = [],\r\n    isLoading,\r\n    error: tanahError,\r\n  } = useQuery({\r\n    queryKey: [\r\n      \"tanah\",\r\n      user?.kecamatan,\r\n      user?.kelurahan,\r\n      user?.role,\r\n      user?.nik,\r\n    ],\r\n    queryFn: async () => {\r\n      if (!user) return [];\r\n      let query = supabase.from(\"tanah\").select(\"*\");\r\n      if (user.role === \"super_admin\") {\r\n        // Tidak ada filter\r\n      } else if (user.role === \"admin_kecamatan\") {\r\n        query = query.eq(\"kecamatan\", user.kecamatan);\r\n      } else if (user.role === \"admin_kelurahan\") {\r\n        query = query.eq(\"kelurahan\", user.kelurahan);\r\n      } else if (user.role === \"member\") {\r\n        query = query.or(\r\n          `nik_pemilik.eq.${user.nik},nik_penerima.eq.${user.nik}`\r\n        );\r\n      } else {\r\n        // fallback: tidak ada data\r\n        return [];\r\n      }\r\n      query = query.order(\"created_date\", { ascending: false });\r\n      const { data, error } = await query;\r\n      if (error) {\r\n        console.error(\"Supabase tanah error:\", error);\r\n        throw new Error(error.message);\r\n      }\r\n      return data || [];\r\n    },\r\n    enabled: !!user,\r\n  });\r\n\r\n  // Filtered tanah and pagination logic must be after tanahList declaration\r\n  const filteredTanah = tanahList.filter((tanah) => {\r\n    const matchSearch =\r\n      tanah.nama_pemilik?.toLowerCase().includes(searchTerm.toLowerCase()) ||\r\n      tanah.nama_penerima?.toLowerCase().includes(searchTerm.toLowerCase()) ||\r\n      tanah.nik_pemilik?.includes(searchTerm) ||\r\n      tanah.lokasi?.toLowerCase().includes(searchTerm.toLowerCase());\r\n    const matchStatus = filterStatus === \"all\" || tanah.status === filterStatus;\r\n    return matchSearch && matchStatus;\r\n  });\r\n  const totalPages = Math.ceil(filteredTanah.length / pageSize);\r\n  const paginatedTanah = filteredTanah.slice(\r\n    (page - 1) * pageSize,\r\n    page * pageSize\r\n  );\r\n\r\n  const queryClient = useQueryClient();\r\n\r\n  useEffect(() => {\r\n    // Ambil user aplikasi berdasarkan auth_id Supabase Auth\r\n    const getUser = async () => {\r\n      const {\r\n        data: { user: authUser },\r\n      } = await supabase.auth.getUser();\r\n      if (authUser) {\r\n        const { data: userApp } = await supabase\r\n          .from(\"users\")\r\n          .select(\"*\")\r\n          .eq(\"auth_id\", authUser.id)\r\n          .single();\r\n        // Gabungkan data user dari auth dan tabel users\r\n        setUser({\r\n          ...authUser,\r\n          ...userApp,\r\n        });\r\n      }\r\n    };\r\n    getUser();\r\n  }, []);\r\n\r\n  // useEffect reset searchTerm & filterStatus dihapus agar input search/filter bisa digunakan\r\n\r\n  // ...existing code...\r\n\r\n  const deleteMutation = useMutation({\r\n    mutationFn: async (id) => {\r\n      const { error } = await supabase.from(\"tanah\").delete().eq(\"id\", id);\r\n      if (error) throw new Error(error.message);\r\n    },\r\n    onSuccess: () => {\r\n      queryClient.invalidateQueries([\"tanah\"]);\r\n      setDeleteId(null);\r\n      toast.success(\"Data tanah berhasil dihapus\");\r\n    },\r\n    onError: (error) => {\r\n      toast.error(\"Gagal menghapus data: \" + (error.message || error));\r\n    },\r\n  });\r\n\r\n  const handleSubmit = (data) => {\r\n    if (editingTanah) {\r\n      updateMutation.mutate({ id: editingTanah.id, data });\r\n    } else {\r\n      createMutation.mutate({\r\n        ...data,\r\n        kecamatan: data.kecamatan || user?.kecamatan,\r\n        kelurahan: data.kelurahan || user?.kelurahan,\r\n      });\r\n    }\r\n  };\r\n\r\n  // ...existing code...\r\n\r\n  return (\r\n    <div className=\"space-y-6 w-full\">\r\n      {/* Header */}\r\n      <div className=\"\">\r\n        <div className=\"flex flex-col md:flex-row md:items-center md:justify-between gap-4\">\r\n          <div>\r\n            <h1 className=\"text-1xl font-bold text-white flex items-center gap-3\">\r\n              <FileText className=\"w-8 h-8 text-blue-200\" />\r\n              Data Tanah\r\n            </h1>\r\n            <p className=\"text-white text-sm mt-0\">\r\n              Kelola data tanah dan dokumen pertanahan\r\n            </p>\r\n          </div>\r\n          <Button\r\n            onClick={() => navigate(\"/formtanah\")}\r\n            className=\"bg-gradient-to-r border border-2 border-white from-blue-700 via-blue-800 to-blue-900 text-white shadow hover:brightness-110\"\r\n          >\r\n            <Plus className=\"w-4 h-4 mr-2\" />\r\n            Tambah Data\r\n          </Button>\r\n        </div>\r\n\r\n        {/* Summary Card */}\r\n        <Card className=\"border-0 bg-transparent\">\r\n          <CardContent className=\"p-4 flex flex-wrap gap-4 justify-between items-center\">\r\n            <div className=\"font-normal text-white text-sm\">\r\n              Total: {filteredTanah.length} data\r\n            </div>\r\n            <div className=\"font-normal text-white text-sm\">\r\n              Dengan Koordinat:{\" \"}\r\n              {filteredTanah.filter((t) => t.latitude && t.longitude).length}\r\n            </div>\r\n            <div className=\"font-normal text-white text-sm\">\r\n              Tanpa Koordinat:{\" \"}\r\n              {filteredTanah.filter((t) => !t.latitude || !t.longitude).length}\r\n            </div>\r\n            <div className=\"flex items-start gap-4 mt-0\">\r\n              <div className=\"flex items-center gap-2\">\r\n                <span\r\n                  className=\"inline-block w-5 h-5 rounded-full\"\r\n                  style={{\r\n                    background: \"#EAB308\",\r\n                    border: \"2px solid #fff\",\r\n                    boxShadow: \"0 2px 5px rgba(0,0,0,0.15)\",\r\n                  }}\r\n                ></span>\r\n                <span className=\"text-sm text-white font-medium\">Selesai</span>\r\n              </div>\r\n              <div className=\"flex items-center gap-2\">\r\n                <span\r\n                  className=\"inline-block w-5 h-5 rounded-full\"\r\n                  style={{\r\n                    background: \"#3b82f6\",\r\n                    border: \"2px solid #fff\",\r\n                    boxShadow: \"0 2px 5px rgba(0,0,0,0.15)\",\r\n                  }}\r\n                ></span>\r\n                <span className=\"text-sm text-white font-medium\">Proses</span>\r\n              </div>\r\n              <div className=\"flex items-center gap-2\">\r\n                <span\r\n                  className=\"inline-block w-5 h-5 rounded-full\"\r\n                  style={{\r\n                    background: \"#ef4444\",\r\n                    border: \"2px solid #fff\",\r\n                    boxShadow: \"0 2px 5px rgba(0,0,0,0.15)\",\r\n                  }}\r\n                ></span>\r\n                <span className=\"text-sm text-white font-medium\">Ditolak</span>\r\n              </div>\r\n            </div>\r\n          </CardContent>\r\n        </Card>\r\n\r\n        {/* Keterangan warna marker */}\r\n        {/* Filters */}\r\n        <Card className=\"border-0 shadow-md bg-transparent text-white\">\r\n          <CardContent className=\"p-4 border-0 shadow-sm bg-transparent\">\r\n            <div className=\"flex flex-col md:flex-row gap-4\">\r\n              <div className=\"flex-1 relative\">\r\n                <Search className=\"absolute left-3 top-1/2 -translate-y-1/2 w-4 h-4 text-white\" />\r\n                <Input\r\n                  placeholder=\"Cari nama, NIK, atau lokasi...\"\r\n                  value={searchTerm}\r\n                  onChange={(e) => setSearchTerm(e.target.value)}\r\n                  className=\"pl-10 pr-4 h-10 bg-transparent border-white text-white placeholder-white\"\r\n                  style={{ \"::placeholder-text\": { color: \"#fff\" } }}\r\n                />\r\n              </div>\r\n              <Select value={filterStatus} onValueChange={setFilterStatus}>\r\n                <SelectTrigger className=\"w-full md:w-48\">\r\n                  <SelectValue placeholder=\"Filter Status\" />\r\n                </SelectTrigger>\r\n                <SelectContent>\r\n                  <SelectItem value=\"all\">Semua Status</SelectItem>\r\n                  <SelectItem value=\"Proses\">Proses</SelectItem>\r\n                  <SelectItem value=\"Selesai\">Selesai</SelectItem>\r\n                  <SelectItem value=\"Ditolak\">Ditolak</SelectItem>\r\n                </SelectContent>\r\n              </Select>\r\n            </div>\r\n          </CardContent>\r\n        </Card>\r\n      </div>\r\n      {/* Data Grid */}\r\n      {isLoading ? (\r\n        <div className=\"flex justify-center items-center py-12 text-white text-lg\">\r\n          Memuat data...\r\n        </div>\r\n      ) : (\r\n        <div className=\"relative\" style={{ height: \"60vh\", minHeight: 350 }}>\r\n          <div\r\n            className=\"grid gap-4 overflow-auto h-full pr-2\"\r\n            style={{ maxHeight: \"100%\" }}\r\n          >\r\n            <div className=\"overflow-auto rounded-lg shadow bg-white\">\r\n              <table className=\"min-w-full border border-gray-300 w-full\">\r\n                <thead className=\"bg-blue-700\">\r\n                  <tr className=\"border-b-2 border-gray-300\">\r\n                    <th className=\"px-2 py-2 text-left text-xs font-sm text-white uppercase tracking-wider w-8\">\r\n                      No\r\n                    </th>\r\n                    <th className=\"px-4 py-2 text-left text-xs font-sm text-white uppercase tracking-wider\">\r\n                      Nama Pemohon\r\n                    </th>\r\n                    <th className=\"px-4 py-2 text-left text-xs font-sm text-white uppercase tracking-wider\">\r\n                      Nama Penerima\r\n                    </th>\r\n                    <th className=\"px-4 py-2 text-left text-xs font-sm text-white uppercase tracking-wider\">\r\n                      Transaksi\r\n                    </th>\r\n                    <th className=\"px-4 py-2 text-left text-xs font-sm text-white uppercase tracking-wider\">\r\n                      Luas\r\n                    </th>\r\n                    <th className=\"px-4 py-2 text-left text-xs font-sm text-white uppercase tracking-wider\">\r\n                      Wilayah\r\n                    </th>\r\n                    <th className=\"px-4 py-2 text-left text-xs font-sm text-white uppercase tracking-wider\">\r\n                      Status\r\n                    </th>\r\n                    <th className=\"px-4 py-2 text-left text-xs font-sm text-white uppercase tracking-wider\">\r\n                      Aksi\r\n                    </th>\r\n                  </tr>\r\n                </thead>\r\n                <tbody className=\"bg-white divide-y divide-gray-200 \">\r\n                  {paginatedTanah.map((tanah, idx) => (\r\n                    <tr key={tanah.id} className={idx % 2 === 0 ? \"bg-white\" : \"bg-gray-300\"}>\r\n                      <td className=\"px-2 py-2 whitespace-nowrap text-black w-8 text-center align-top \">\r\n                        {(page - 1) * pageSize + idx + 1}\r\n                      </td>\r\n                      <td className=\"px-4 py-2 whitespace-nowrap text-black align-top \">\r\n                        {tanah.nama_pemilik}\r\n                      </td>\r\n                      <td className=\"px-4 py-2 whitespace-nowrap text-black align-top \">\r\n                        {tanah.nama_penerima || \"-\"}\r\n                        {tanah.atas_nama && (\r\n                          <div className=\"text-xs text-gray-500\">\r\n                            {tanah.atas_nama }\r\n                          </div>\r\n                        )}\r\n                      </td>\r\n                      <td className=\"px-4 py-2 whitespace-nowrap text-black \">\r\n                        {tanah.transaksi || \"-\"}\r\n                        {tanah.transaksi && (\r\n                          <div className=\"text-xs text-gray-500\"> Rp.\r\n                            {tanah.harga?.toLocaleString(\"id-ID\")}\r\n                          </div>\r\n                        )}\r\n                      </td>\r\n                      <td className=\"px-4 py-2 whitespace-nowrap text-black \">\r\n                        {tanah.luas_meter % 1 === 0\r\n                          ? Math.floor(tanah.luas_meter)\r\n                          : tanah.luas_meter.toString().replace(\".\", \",\")}{\" \"}\r\n                        m²                       \r\n                          <div className=\"text-xs text-gray-500\">\r\n                            [ {tanah.luas_perkalian} ]\r\n                          </div>\r\n                        \r\n                      </td>\r\n                      <td className=\"px-4 py-2 whitespace-nowrap text-black \">\r\n                        {tanah.kelurahan || \"-\"}\r\n                        {tanah.kelurahan && (\r\n                          <div className=\"text-xs text-gray-500\"> \r\n                            {tanah.kecamatan}\r\n                          </div>\r\n                        )}\r\n                      </td>\r\n                      <td className=\"px-4 py-2 whitespace-nowrap \">\r\n                        <span\r\n                          className={\r\n                            tanah.status === \"Selesai\"\r\n                              ? \"bg-yellow-500 text-white-400 px-2 py-1 rounded text-xs\"\r\n                              : tanah.status === \"Ditolak\"\r\n                                ? \"bg-red-500 text-white-400 px-2 py-1 rounded text-xs\"\r\n                                : \"bg-blue-500 text-white-400 px-2 py-1 rounded text-xs\"\r\n                          }\r\n                        >\r\n                          {tanah.status || \"Proses\"}\r\n                        </span>\r\n                      </td>\r\n                      <td className=\"px-2 py-2 whitespace-nowrap flex  gap-2\">\r\n                        <Link\r\n                          to={createPageUrl(\"DetailTanah\") + `?id=${tanah.id}`}\r\n                        >\r\n                          <Button\r\n                            variant=\"outline\"\r\n                            size=\"sm\"\r\n                            className=\"text-blue-600 border-blue-200 hover:bg-blue-50\"\r\n                          >\r\n                            <Eye className=\"w-4 h-4 mr-1\" />\r\n                            Detail\r\n                          </Button>\r\n                        </Link>\r\n                        <Link\r\n                          to={createPageUrl(\"PetaTanah\") + `?id=${tanah.id}`}\r\n                        >\r\n                          <Button\r\n                            variant=\"outline\"\r\n                            size=\"sm\"\r\n                            className={\r\n                              tanah.latitude && tanah.longitude\r\n                                ? \"text-teal-600 border-teal-200 hover:bg-teal-50\"\r\n                                : \"text-slate-400 border-slate-200\"\r\n                            }\r\n                            disabled={!tanah.latitude || !tanah.longitude}\r\n                          >\r\n                            <Map className=\"w-4 h-4 mr-1\" />\r\n                            Peta\r\n                          </Button>\r\n                        </Link>\r\n                        <Button\r\n                          variant=\"outline\"\r\n                          size=\"sm\"\r\n                          onClick={() => navigate(`/formtanah?id=${tanah.id}`)}\r\n                          className=\"text-orange-600 border-orange-200 hover:bg-orange-50\"\r\n                        >\r\n                          <Pencil className=\"w-4 h-4\" />\r\n                        </Button>\r\n                        <Button\r\n                          variant=\"outline\"\r\n                          size=\"sm\"\r\n                          onClick={() => {\r\n                            const valueStr = `${tanah.nama_pemilik} → ${tanah.nama_penerima\r\n                              } (${tanah.transaksi || \"Transaksi\"})`;\r\n                            navigate(\r\n                              `/laporan?tanah=${encodeURIComponent(valueStr)}`\r\n                            );\r\n                          }}\r\n                          className=\"text-purple-600 border-purple-200 hover:bg-purple-50\"\r\n                        >\r\n                          <Printer className=\"w-4 h-4\" />\r\n                        </Button>\r\n                        <Button\r\n                          variant=\"outline\"\r\n                          size=\"sm\"\r\n                          onClick={() => setQrTanah(tanah)}\r\n                          className=\"text-green-600 border-green-200 hover:bg-green-50\"\r\n                        >\r\n                          <QrCode className=\"w-4 h-4\" />\r\n                        </Button>\r\n                        <Button\r\n                          variant=\"outline\"\r\n                          size=\"sm\"\r\n                          onClick={() => setDeleteId(tanah.id)}\r\n                          className=\"text-red-600 border-red-200 hover:bg-red-50\"\r\n                        >\r\n                          <Trash2 className=\"w-4 h-4\" />\r\n                        </Button>\r\n                      </td>\r\n                    </tr>\r\n                  ))}\r\n                </tbody>\r\n              </table>\r\n            </div>\r\n\r\n            {filteredTanah.length === 0 && (\r\n              <Card className=\"border-0 shadow-md\">\r\n                <CardContent className=\"p-12 text-center\">\r\n                  <FileText className=\"w-12 h-12 text-slate-300 mx-auto mb-4\" />\r\n                  <h3 className=\"text-lg font-medium text-slate-600\">\r\n                    Belum ada data tanah\r\n                  </h3>\r\n                  <p className=\"text-slate-400 mt-1\">\r\n                    Klik tombol \"Tambah Data\" untuk menambahkan data baru\r\n                  </p>\r\n                </CardContent>\r\n              </Card>\r\n            )}\r\n          </div>\r\n        </div>\r\n      )}\r\n      {/* Pagination */}\r\n      {totalPages > 1 && (\r\n        <div className=\"flex justify-center items-center gap-2 mt-6\">\r\n          <Button\r\n            onClick={() => setPage(page - 1)}\r\n            disabled={page === 1}\r\n            className=\"px-3 py-1 rounded bg-gradient-to-r from-blue-700 via-blue-800 to-blue-900 text-white disabled:opacity-50\"\r\n          >\r\n            &lt;\r\n          </Button>\r\n          <span className=\"text-sm text-white\">\r\n            Halaman {page} dari {totalPages}\r\n          </span>\r\n          <Button\r\n            onClick={() => setPage(page + 1)}\r\n            disabled={page === totalPages}\r\n            className=\"px-3 py-1 border border-2 border-white rounded bg-gradient-to-r from-blue-700 via-blue-800 to-blue-900 text-white disabled:opacity-50\"\r\n          >\r\n            &gt;\r\n          </Button>\r\n        </div>\r\n      )}\r\n\r\n      {/* Error Handling */}\r\n      {tanahError && (\r\n        <div className=\"p-4 bg-red-100 text-red-700 rounded mb-4\">\r\n          Gagal memuat data tanah: {tanahError.message}\r\n        </div>\r\n      )}\r\n\r\n      {/* Delete Confirmation */}\r\n      <AlertDialog\r\n        open={!!deleteId}\r\n        onOpenChange={(open) => {\r\n          if (!open) setDeleteId(null);\r\n        }}\r\n      >\r\n        <AlertDialogContent className=\"bg-white\">\r\n          <AlertDialogHeader>\r\n            <AlertDialogTitle>Hapus Data Tanah?</AlertDialogTitle>\r\n            <AlertDialogDescription>\r\n              Tindakan ini tidak dapat dibatalkan. Data tanah akan dihapus\r\n              secara permanen.\r\n            </AlertDialogDescription>\r\n          </AlertDialogHeader>\r\n          <AlertDialogFooter>\r\n            <AlertDialogCancel>Batal</AlertDialogCancel>\r\n            <AlertDialogAction\r\n              onClick={() => deleteMutation.mutate(deleteId)}\r\n              className=\"bg-red-600 hover:bg-red-700\"\r\n            >\r\n              Hapus\r\n            </AlertDialogAction>\r\n          </AlertDialogFooter>\r\n        </AlertDialogContent>\r\n      </AlertDialog>\r\n\r\n      {/* QR Code Modal */}\r\n      <Dialog open={!!qrTanah} onOpenChange={() => setQrTanah(null)}>\r\n        <DialogContent className=\"sm:max-w-md\">\r\n          <DialogHeader>\r\n            <DialogTitle className=\"text-center\">\r\n              QR Code Lokasi Tanah\r\n            </DialogTitle>\r\n          </DialogHeader>\r\n          <div className=\"flex flex-col items-center space-y-4 p-4\">\r\n            <div className=\"text-center space-y-1\">\r\n              <p className=\"font-medium text-slate-800\">\r\n                {qrTanah?.nama_pemilik}\r\n                {qrTanah?.nama_penerima && (\r\n                  <> diserahkan kepada {qrTanah?.nama_penerima}</>\r\n                )}\r\n                {qrTanah?.atas_nama && <> / {qrTanah?.atas_nama}</>}\r\n              </p>\r\n              <p className=\"text-sm text-slate-500\">\r\n                {(qrTanah?.luas_meter || 0) % 1 === 0\r\n                  ? Math.floor(qrTanah?.luas_meter || 0)\r\n                  : (qrTanah?.luas_meter || 0)\r\n                    .toString()\r\n                    .replace(\".\", \",\")}{\" \"}\r\n                m²\r\n              </p>\r\n              <p className=\"text-xs text-slate-400\">\r\n                {qrTanah?.latitude}, {qrTanah?.longitude}\r\n              </p>\r\n            </div>\r\n            <div className=\"bg-white p-4 rounded-lg border-2 border-slate-200\">\r\n              <img\r\n                src={`https://api.qrserver.com/v1/create-qr-code/?size=300x300&data=${encodeURIComponent(\r\n                  `https://www.google.com/maps?q=${qrTanah?.latitude},${qrTanah?.longitude}`\r\n                )}`}\r\n                alt=\"QR Code\"\r\n                className=\"w-64 h-64\"\r\n              />\r\n            </div>\r\n            <p className=\"text-xs text-center text-slate-500\">\r\n              Scan QR code untuk melihat lokasi di Google Maps\r\n            </p>\r\n            <Button\r\n              onClick={() => {\r\n                const googleMapsUrl = `https://www.google.com/maps?q=${qrTanah?.latitude},${qrTanah?.longitude}`;\r\n                window.open(googleMapsUrl, \"_blank\");\r\n              }}\r\n              className=\"w-full bg-green-600 hover:bg-green-700\"\r\n            >\r\n              <MapPin className=\"w-4 h-4 mr-2\" />\r\n              Buka di Google Maps\r\n            </Button>\r\n          </div>\r\n        </DialogContent>\r\n      </Dialog>\r\n    </div>\r\n  );\r\n}\r\n"],"names":["DataTanah","page","setPage","useState","user","setUser","searchTerm","setSearchTerm","filterStatus","setFilterStatus","deleteId","setDeleteId","qrTanah","setQrTanah","navigate","useNavigate","useEffect","data","tanahList","isLoading","error","tanahError","useQuery","queryKey","kecamatan","kelurahan","role","nik","queryFn","async","query","supabase","from","select","eq","or","order","ascending","console","Error","message","enabled","filteredTanah","filter","tanah","matchSearch","nama_pemilik","toLowerCase","includes","nama_penerima","nik_pemilik","lokasi","matchStatus","status","totalPages","Math","ceil","length","paginatedTanah","slice","queryClient","useQueryClient","authUser","auth","getUser","userApp","id","single","deleteMutation","useMutation","mutationFn","delete","onSuccess","invalidateQueries","toast","success","onError","jsxs","className","children","jsx","FileText","Button","onClick","Plus","Card","CardContent","t","latitude","longitude","style","background","border","boxShadow","Search","Input","placeholder","value","onChange","e","target","color","Select","onValueChange","SelectTrigger","SelectValue","SelectContent","SelectItem","height","minHeight","maxHeight","map","idx","atas_nama","transaksi","harga","toLocaleString","luas_meter","floor","toString","replace","luas_perkalian","Link","to","createPageUrl","variant","size","Eye","disabled","Map","Pencil","valueStr","encodeURIComponent","Printer","QrCode","Trash2","AlertDialog","open","onOpenChange","AlertDialogContent","AlertDialogHeader","AlertDialogTitle","AlertDialogDescription","AlertDialogFooter","AlertDialogCancel","AlertDialogAction","mutate","Dialog","DialogContent","DialogHeader","DialogTitle","Fragment","src","alt","googleMapsUrl","window","MapPin"],"mappings":"ghBAmDA,SAAwBA,IAEtB,MAAOC,EAAMC,GAAWC,EAAAA,SAAS,IAE1BC,EAAMC,GAAWF,EAAAA,SAAS,OAC1BG,EAAYC,GAAiBJ,EAAAA,SAAS,KACtCK,EAAcC,GAAmBN,EAAAA,SAAS,QAC1CO,EAAUC,GAAeR,EAAAA,SAAS,OAClCS,EAASC,GAAcV,EAAAA,SAAS,MACjCW,EAAWC,IAGjBC,EAAAA,UAAU,KACRd,EAAQ,IACP,CAACI,EAAYE,IAGhB,MACES,KAAMC,GAAY,GAAAC,UAClBA,GACAC,MAAOC,IACLC,EAAS,CACXC,SAAU,CACR,QACAnB,GAAMoB,UACNpB,GAAMqB,UACNrB,GAAMsB,KACNtB,GAAMuB,KAERC,QAASC,UACP,IAAKzB,EAAM,MAAO,GAClB,IAAI0B,EAAQC,EAASC,KAAK,SAASC,OAAO,KAC1C,GAAkB,gBAAd7B,EAAKsB,WAAwB,GAER,oBAAdtB,EAAKsB,KACdI,EAAQA,EAAMI,GAAG,YAAa9B,EAAKoB,gBACrC,GAAyB,oBAAdpB,EAAKsB,KACdI,EAAQA,EAAMI,GAAG,YAAa9B,EAAKqB,eACrC,IAAyB,WAAdrB,EAAKsB,KAMd,MAAO,GALPI,EAAQA,EAAMK,GACZ,kBAAkB/B,EAAKuB,uBAAuBvB,EAAKuB,MAKvD,CACAG,EAAQA,EAAMM,MAAM,eAAgB,CAAEC,WAAW,IACjD,MAAMpB,KAAEA,EAAAG,MAAMA,SAAgBU,EAC9B,GAAIV,EAEF,MADAkB,QAAQlB,MAAM,wBAAyBA,GACjC,IAAImB,MAAMnB,EAAMoB,SAExB,OAAOvB,GAAQ,IAEjBwB,UAAWrC,IAIPsC,GAAgBxB,GAAUyB,OAAQC,IACtC,MAAMC,EACJD,EAAME,cAAcC,cAAcC,SAAS1C,EAAWyC,gBACtDH,EAAMK,eAAeF,cAAcC,SAAS1C,EAAWyC,gBACvDH,EAAMM,aAAaF,SAAS1C,IAC5BsC,EAAMO,QAAQJ,cAAcC,SAAS1C,EAAWyC,eAC5CK,EAA+B,QAAjB5C,GAA0BoC,EAAMS,SAAW7C,EAC/D,OAAOqC,GAAeO,IAElBE,GAAaC,KAAKC,KAAKd,GAAce,OAhE1B,GAiEXC,GAAiBhB,GAAciB,MAjEpB,GAkEd1D,EAAO,GAlEO,EAmEfA,GAGI2D,GAAcC,IAEpB7C,EAAAA,UAAU,KAEQa,WACd,MACEZ,MAAQb,KAAM0D,UACN/B,EAASgC,KAAKC,UACxB,GAAIF,EAAU,CACZ,MAAQ7C,KAAMgD,SAAkBlC,EAC7BC,KAAK,SACLC,OAAO,KACPC,GAAG,UAAW4B,EAASI,IACvBC,SAEH9D,EAAQ,IACHyD,KACAG,GAEP,GAEFD,IACC,IAMH,MAAMI,GAAiBC,EAAY,CACjCC,WAAYzC,MAAOqC,IACjB,MAAM9C,MAAEA,SAAgBW,EAASC,KAAK,SAASuC,SAASrC,GAAG,KAAMgC,GACjE,GAAI9C,EAAO,MAAM,IAAImB,MAAMnB,EAAMoB,UAEnCgC,UAAW,KACTZ,GAAYa,kBAAkB,CAAC,UAC/B9D,EAAY,MACZ+D,EAAMC,QAAQ,gCAEhBC,QAAUxD,IACRsD,EAAMtD,MAAM,0BAA4BA,EAAMoB,SAAWpB,OAkB7D,SACEyD,KAAC,MAAA,CAAIC,UAAU,mBAEbC,SAAA,GAAAF,KAAC,MAAA,CAAIC,UAAU,GACbC,SAAA,GAAAF,KAAC,MAAA,CAAIC,UAAU,qEACbC,SAAA,CAAAF,OAAC,MAAA,CACCE,SAAA,GAAAF,KAAC,KAAA,CAAGC,UAAU,wDACZC,SAAA,GAAAC,IAACC,EAAA,CAASH,UAAU,0BAA0B,gBAGhDE,EAAAA,IAAC,IAAA,CAAEF,UAAU,0BAA0BC,SAAA,gDAIzCF,EAAAA,KAACK,EAAA,CACCC,QAAS,IAAMrE,EAAS,cACxBgE,UAAU,8HAEVC,SAAA,GAAAC,IAACI,EAAA,CAAKN,UAAU,iBAAiB,0BAMpCO,EAAA,CAAKP,UAAU,0BACdC,SAAAF,EAAAA,KAACS,EAAA,CAAYR,UAAU,wDACrBC,SAAA,GAAAF,KAAC,MAAA,CAAIC,UAAU,iCAAiCC,SAAA,CAAA,UACtCrC,GAAce,OAAO,aAE/BoB,KAAC,MAAA,CAAIC,UAAU,iCAAiCC,SAAA,CAAA,oBAC5B,IACjBrC,GAAcC,OAAQ4C,GAAMA,EAAEC,UAAYD,EAAEE,WAAWhC,YAE1DoB,KAAC,MAAA,CAAIC,UAAU,iCAAiCC,SAAA,CAAA,mBAC7B,IAChBrC,GAAcC,OAAQ4C,IAAOA,EAAEC,WAAaD,EAAEE,WAAWhC,YAE5DoB,KAAC,MAAA,CAAIC,UAAU,8BACbC,SAAA,GAAAF,KAAC,MAAA,CAAIC,UAAU,0BACbC,SAAA,CAAAC,EAAAA,IAAC,OAAA,CACCF,UAAU,oCACVY,MAAO,CACLC,WAAY,UACZC,OAAQ,iBACRC,UAAW,gCAGfb,EAAAA,IAAC,OAAA,CAAKF,UAAU,iCAAiCC,SAAA,iBAEnDF,KAAC,MAAA,CAAIC,UAAU,0BACbC,SAAA,CAAAC,EAAAA,IAAC,OAAA,CACCF,UAAU,oCACVY,MAAO,CACLC,WAAY,UACZC,OAAQ,iBACRC,UAAW,gCAGfb,EAAAA,IAAC,OAAA,CAAKF,UAAU,iCAAiCC,SAAA,gBAEnDF,KAAC,MAAA,CAAIC,UAAU,0BACbC,SAAA,CAAAC,EAAAA,IAAC,OAAA,CACCF,UAAU,oCACVY,MAAO,CACLC,WAAY,UACZC,OAAQ,iBACRC,UAAW,gCAGfb,EAAAA,IAAC,OAAA,CAAKF,UAAU,iCAAiCC,SAAA,uBAQzDC,EAAAA,IAACK,EAAA,CAAKP,UAAU,+CACdC,WAAAC,IAACM,EAAA,CAAYR,UAAU,wCACrBC,SAAAF,OAAC,MAAA,CAAIC,UAAU,kCACbC,SAAA,GAAAF,KAAC,MAAA,CAAIC,UAAU,kBACbC,SAAA,GAAAC,IAACc,EAAA,CAAOhB,UAAU,gEAClBE,EAAAA,IAACe,EAAA,CACCC,YAAY,iCACZC,MAAO3F,EACP4F,SAAWC,GAAM5F,EAAc4F,EAAEC,OAAOH,OACxCnB,UAAU,2EACVY,MAAO,CAAE,qBAAsB,CAAEW,MAAO,cAG5CxB,EAAAA,KAACyB,EAAA,CAAOL,MAAOzF,EAAc+F,cAAe9F,EAC1CsE,SAAA,CAAAC,EAAAA,IAACwB,GAAc1B,UAAU,iBACvBC,eAAC0B,EAAA,CAAYT,YAAY,2BAE1BU,EAAA,CACC3B,SAAA,CAAAC,EAAAA,IAAC2B,EAAA,CAAWV,MAAM,MAAMlB,SAAA,iBACxBC,EAAAA,IAAC2B,EAAA,CAAWV,MAAM,SAASlB,SAAA,WAC3BC,EAAAA,IAAC2B,EAAA,CAAWV,MAAM,UAAUlB,SAAA,YAC5BC,EAAAA,IAAC2B,EAAA,CAAWV,MAAM,UAAUlB,SAAA,4BAQvC5D,GACC6D,EAAAA,IAAC,MAAA,CAAIF,UAAU,4DAA4DC,4BAI3EC,MAAC,MAAA,CAAIF,UAAU,WAAWY,MAAO,CAAEkB,OAAQ,OAAQC,UAAW,KAC5D9B,SAAAF,EAAAA,KAAC,MAAA,CACCC,UAAU,uCACVY,MAAO,CAAEoB,UAAW,QAEpB/B,SAAA,CAAAC,EAAAA,IAAC,OAAIF,UAAU,2CACbC,SAAAF,EAAAA,KAAC,QAAA,CAAMC,UAAU,2CACfC,SAAA,CAAAC,EAAAA,IAAC,SAAMF,UAAU,cACfC,SAAAF,EAAAA,KAAC,KAAA,CAAGC,UAAU,6BACZC,SAAA,CAAAC,EAAAA,IAAC,KAAA,CAAGF,UAAU,8EAA8EC,SAAA,OAG5FC,EAAAA,IAAC,KAAA,CAAGF,UAAU,0EAA0EC,SAAA,iBAGxFC,EAAAA,IAAC,KAAA,CAAGF,UAAU,0EAA0EC,SAAA,kBAGxFC,EAAAA,IAAC,KAAA,CAAGF,UAAU,0EAA0EC,SAAA,cAGxFC,EAAAA,IAAC,KAAA,CAAGF,UAAU,0EAA0EC,SAAA,SAGxFC,EAAAA,IAAC,KAAA,CAAGF,UAAU,0EAA0EC,SAAA,YAGxFC,EAAAA,IAAC,KAAA,CAAGF,UAAU,0EAA0EC,SAAA,WAGxFC,EAAAA,IAAC,KAAA,CAAGF,UAAU,0EAA0EC,SAAA,oBAK3F,QAAA,CAAMD,UAAU,qCACdC,SAAArB,GAAeqD,IAAI,CAACnE,EAAOoE,IAC1BnC,EAAAA,KAAC,MAAkBC,UAAWkC,EAAM,GAAM,EAAI,WAAa,cACzDjC,SAAA,CAAAC,EAAAA,IAAC,MAAGF,UAAU,oEACVC,SArRP,KAqRc,GAAgBiC,EAAM,IAEjChC,EAAAA,IAAC,KAAA,CAAGF,UAAU,oDACXC,WAAMjC,iBAET+B,KAAC,KAAA,CAAGC,UAAU,oDACXC,SAAA,CAAAnC,EAAMK,eAAiB,IACvBL,EAAMqE,WACLjC,EAAAA,IAAC,OAAIF,UAAU,wBACZC,WAAMkC,iBAIbpC,KAAC,KAAA,CAAGC,UAAU,0CACXC,SAAA,CAAAnC,EAAMsE,WAAa,IACnBtE,EAAMsE,WACLrC,OAAC,MAAA,CAAIC,UAAU,wBAAwBC,SAAA,CAAA,OACpCnC,EAAMuE,OAAOC,eAAe,iBAInCvC,KAAC,KAAA,CAAGC,UAAU,0CACXC,SAAA,CAAAnC,EAAMyE,WAAa,GAAM,EACtB9D,KAAK+D,MAAM1E,EAAMyE,YACjBzE,EAAMyE,WAAWE,WAAWC,QAAQ,IAAK,KAAM,IAAI,OAErD3C,KAAC,MAAA,CAAIC,UAAU,wBAAwBC,SAAA,CAAA,KAClCnC,EAAM6E,eAAe,aAI9B5C,KAAC,KAAA,CAAGC,UAAU,0CACXC,SAAA,CAAAnC,EAAMnB,WAAa,IACnBmB,EAAMnB,WACLuD,EAAAA,IAAC,OAAIF,UAAU,wBACZC,WAAMvD,iBAIbwD,IAAC,KAAA,CAAGF,UAAU,+BACZC,SAAAC,EAAAA,IAAC,OAAA,CACCF,UACmB,YAAjBlC,EAAMS,OACF,yDACiB,YAAjBT,EAAMS,OACJ,sDACA,uDAGP0B,WAAM1B,QAAU,eAGrBwB,KAAC,KAAA,CAAGC,UAAU,0CACZC,SAAA,CAAAC,EAAAA,IAAC0C,EAAA,CACCC,GAAIC,EAAc,eAAiB,OAAOhF,EAAMsB,KAEhDa,SAAAF,EAAAA,KAACK,EAAA,CACC2C,QAAQ,UACRC,KAAK,KACLhD,UAAU,iDAEVC,SAAA,GAAAC,IAAC+C,EAAA,CAAIjD,UAAU,iBAAiB,cAIpCE,EAAAA,IAAC0C,EAAA,CACCC,GAAIC,EAAc,aAAe,OAAOhF,EAAMsB,KAE9Ca,SAAAF,EAAAA,KAACK,EAAA,CACC2C,QAAQ,UACRC,KAAK,KACLhD,UACElC,EAAM4C,UAAY5C,EAAM6C,UACpB,iDACA,kCAENuC,UAAWpF,EAAM4C,WAAa5C,EAAM6C,UAEpCV,SAAA,GAAAC,IAACiD,EAAA,CAAInD,UAAU,iBAAiB,YAIpCE,EAAAA,IAACE,EAAA,CACC2C,QAAQ,UACRC,KAAK,KACL3C,QAAS,IAAMrE,EAAS,iBAAiB8B,EAAMsB,MAC/CY,UAAU,uDAEVC,SAAAC,EAAAA,IAACkD,EAAA,CAAOpD,UAAU,cAEpBE,EAAAA,IAACE,EAAA,CACC2C,QAAQ,UACRC,KAAK,KACL3C,QAAS,KACP,MAAMgD,EAAW,GAAGvF,EAAME,kBAAkBF,EAAMK,kBAC3CL,EAAMsE,WAAa,eAC1BpG,EACE,kBAAkBsH,mBAAmBD,OAGzCrD,UAAU,uDAEVC,SAAAC,EAAAA,IAACqD,EAAA,CAAQvD,UAAU,cAErBE,EAAAA,IAACE,EAAA,CACC2C,QAAQ,UACRC,KAAK,KACL3C,QAAS,IAAMtE,EAAW+B,GAC1BkC,UAAU,oDAEVC,SAAAC,EAAAA,IAACsD,EAAA,CAAOxD,UAAU,cAEpBE,EAAAA,IAACE,EAAA,CACC2C,QAAQ,UACRC,KAAK,KACL3C,QAAS,IAAMxE,EAAYiC,EAAMsB,IACjCY,UAAU,8CAEVC,SAAAC,EAAAA,IAACuD,EAAA,CAAOzD,UAAU,mBAxHflC,EAAMsB,YAiIG,IAAzBxB,GAAce,QACbuB,EAAAA,IAACK,EAAA,CAAKP,UAAU,qBACdC,WAAAF,KAACS,EAAA,CAAYR,UAAU,mBACrBC,SAAA,GAAAC,IAACC,EAAA,CAASH,UAAU,0CACpBE,EAAAA,IAAC,KAAA,CAAGF,UAAU,qCAAqCC,SAAA,yBAGnDC,EAAAA,IAAC,IAAA,CAAEF,UAAU,sBAAsBC,SAAA,oEAU9CzB,GAAa,GACZuB,OAAC,MAAA,CAAIC,UAAU,8CACbC,SAAA,CAAAC,EAAAA,IAACE,EAAA,CACCC,QAAS,IAAMjF,EAAQD,EAAO,GAC9B+H,SAAmB,IAAT/H,EACV6E,UAAU,2GACXC,SAAA,QAGDF,KAAC,OAAA,CAAKC,UAAU,qBAAqBC,SAAA,CAAA,WAC1B9E,EAAK,SAAOqD,MAEvB0B,EAAAA,IAACE,EAAA,CACCC,QAAS,IAAMjF,EAAQD,EAAO,GAC9B+H,SAAU/H,IAASqD,GACnBwB,UAAU,wIACXC,SAAA,SAOJ1D,IACCwD,EAAAA,KAAC,MAAA,CAAIC,UAAU,2CAA2CC,SAAA,CAAA,4BAC9B1D,GAAWmB,WAKzCwC,EAAAA,IAACwD,EAAA,CACCC,OAAQ/H,EACRgI,aAAeD,IACRA,GAAM9H,EAAY,OAGzBoE,SAAAF,EAAAA,KAAC8D,EAAA,CAAmB7D,UAAU,WAC5BC,SAAA,CAAAF,OAAC+D,EAAA,CACC7D,SAAA,GAAAC,IAAC6D,GAAiB9D,SAAA,wBAClBC,IAAC8D,GAAuB/D,SAAA,4FAKzBgE,EAAA,CACChE,SAAA,GAAAC,IAACgE,GAAkBjE,SAAA,UACnBC,EAAAA,IAACiE,EAAA,CACC9D,QAAS,IAAMf,GAAe8E,OAAOxI,GACrCoE,UAAU,8BACXC,SAAA,kBAQPC,EAAAA,IAACmE,EAAA,CAAOV,OAAQ7H,EAAS8H,aAAc,IAAM7H,EAAW,MACtDkE,SAAAF,OAACuE,EAAA,CAActE,UAAU,cACvBC,SAAA,CAAAC,EAAAA,IAACqE,GACCtE,SAAAC,EAAAA,IAACsE,EAAA,CAAYxE,UAAU,cAAcC,sCAIvCF,KAAC,MAAA,CAAIC,UAAU,2CACbC,SAAA,GAAAF,KAAC,MAAA,CAAIC,UAAU,wBACbC,SAAA,GAAAF,KAAC,IAAA,CAAEC,UAAU,6BACVC,SAAA,CAAAnE,GAASkC,aACTlC,GAASqC,eACR4B,EAAAA,KAAA0E,EAAAA,SAAA,CAAExE,SAAA,CAAA,sBAAoBnE,GAASqC,iBAEhCrC,GAASqG,WAAapC,EAAAA,KAAA0E,EAAAA,SAAA,CAAExE,SAAA,CAAA,MAAInE,GAASqG,kBAExCpC,KAAC,IAAA,CAAEC,UAAU,yBACTC,SAAA,EAAAnE,GAASyG,YAAc,GAAK,GAAM,EAChC9D,KAAK+D,MAAM1G,GAASyG,YAAc,IACjCzG,GAASyG,YAAc,GACvBE,WACAC,QAAQ,IAAK,KAAM,IAAI,UAG9B3C,KAAC,IAAA,CAAEC,UAAU,yBACVC,SAAA,CAAAnE,GAAS4E,SAAS,KAAG5E,GAAS6E,kBAGnCT,IAAC,MAAA,CAAIF,UAAU,oDACbC,SAAAC,EAAAA,IAAC,MAAA,CACCwE,IAAK,iEAAiEpB,mBACpE,iCAAiCxH,GAAS4E,YAAY5E,GAAS6E,eAEjEgE,IAAI,UACJ3E,UAAU,gBAGdE,EAAAA,IAAC,IAAA,CAAEF,UAAU,qCAAqCC,SAAA,qDAGlDF,EAAAA,KAACK,EAAA,CACCC,QAAS,KACP,MAAMuE,EAAgB,iCAAiC9I,GAAS4E,YAAY5E,GAAS6E,YACrFkE,OAAOlB,KAAKiB,EAAe,WAE7B5E,UAAU,yCAEVC,SAAA,GAAAC,IAAC4E,EAAA,CAAO9E,UAAU,iBAAiB,mCAQjD"}