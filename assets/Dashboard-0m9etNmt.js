import{j as e,s as p,r as u,v as k,w as v,x as N,y as C,X as S,E as M,A as E}from"./vendor-CDA6I53B.js";import{s as D}from"./db-CzWppX9X.js";import{g as T}from"./authUser-TFq9JjWq.js";import{C as f,a as w}from"./card-DKMhJA2Q.js";import{B as g}from"./badge-BNLm1yiM.js";import{T as $}from"./TanahMap-Cz2kfIE4.js";import"./leaflet-D651TNsF.js";import"./index-yx-jgwg1.js";import"./pdf-BL6BoWiN.js";import"./utils-DzPFn8M0.js";function c({title:t,value:d,icon:l,color:m,subtext:i}){const n={blue:{card:"bg-gradient-to-br from-blue-500 to-blue-600",icon:"bg-white/20 text-white",text:"text-white",subtext:"text-blue-100"},green:{card:"bg-gradient-to-br from-emerald-500 to-emerald-600",icon:"bg-white/20 text-white",text:"text-white",subtext:"text-emerald-100"},orange:{card:"bg-gradient-to-br from-orange-500 to-orange-600",icon:"bg-white/20 text-white",text:"text-white",subtext:"text-orange-100"},purple:{card:"bg-gradient-to-br from-purple-500 to-purple-600",icon:"bg-white/20 text-white",text:"text-white",subtext:"text-purple-100"},red:{card:"bg-gradient-to-br from-red-500 to-red-600",icon:"bg-white/20 text-white",text:"text-white",subtext:"text-red-100"},yellow:{card:"bg-gradient-to-br from-yellow-400 to-yellow-500",icon:"bg-white/20 text-white",text:"text-white",subtext:"text-yellow-100"}},s=n[m]||n.blue;return e.jsx(p.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.3},children:e.jsx(f,{className:`border-0 shadow-lg hover:shadow-xl transition-all duration-300 ${s.card}`,children:e.jsx(w,{className:"p-6",children:e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:`text-sm font-medium mb-1 ${s.subtext}`,children:t}),e.jsx("h3",{className:`text-3xl font-bold ${s.text}`,children:d}),i&&e.jsx("p",{className:`text-xs mt-1 ${s.subtext}`,children:i})]}),e.jsx("div",{className:`p-3 rounded-xl ${s.icon}`,children:e.jsx(l,{className:"w-6 h-6"})})]})})})})}function Q(){const[t,d]=u.useState(null),[l,m]=u.useState(!0);u.useEffect(()=>{(async()=>{const x=await T();d(x)})()},[]);const i=t?.role==="super_admin",n=t?.role==="admin",s=t?.role==="admin_kecamatan",h=!!(t&&(i||n||s||t.kecamatan&&t.kelurahan)),{data:r=[],isLoading:y}=k({queryKey:["tanah",i?"all":t?.kecamatan,s?void 0:t?.kelurahan],queryFn:async()=>{if(!t)return[];let a=D.from("tanah").select("*");if(s){if(!t.kecamatan)return[];a=a.eq("kecamatan",t.kecamatan)}else if(!i&&!n){if(!t.kecamatan||!t.kelurahan)return[];a=a.match({kecamatan:t.kecamatan,kelurahan:t.kelurahan})}const{data:x,error:b}=await a;if(b)throw new Error(b.message);return x||[]},enabled:h}),o={total:r.length,proses:r.filter(a=>a.status==="Proses").length,selesai:r.filter(a=>a.status==="Selesai").length,ditolak:r.filter(a=>a.status==="Ditolak").length};r.slice(0,5);const j=r.length>0&&r[0].latitude?[r[0].latitude,r[0].longitude]:[-.8317,119.8707];return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex flex-col md:flex-row md:items-center md:justify-between gap-4",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold text-slate-800",children:"Dashboard"}),e.jsxs("p",{className:"text-slate-500 mt-1",children:["Selamat datang, ",t?.full_name||"User"]})]}),!i&&e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(g,{variant:"secondary",className:"bg-blue-100 text-blue-700",children:t?.kecamatan||"-"}),e.jsx(g,{variant:"secondary",className:"bg-emerald-100 text-emerald-700",children:t?.kelurahan||"-"})]})]}),t?h?y?e.jsx("div",{className:"text-center text-slate-500 py-8",children:"Memuat data tanah..."}):e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-4",children:[e.jsx(c,{title:"Total Data Tanah",value:o.total,icon:v,color:"green",subtext:"Keseluruhan data"}),e.jsx(c,{title:"Dalam Proses",value:o.proses,icon:N,color:"blue",subtext:"Menunggu verifikasi"}),e.jsx(c,{title:"Selesai",value:o.selesai,icon:C,color:"yellow",subtext:"Telah terverifikasi"}),e.jsx(c,{title:"Ditolak",value:o.ditolak,icon:S,color:"red",subtext:"Perlu revisi"})]}):e.jsx("div",{className:"text-center text-slate-500 py-8",children:i||n?"Memuat data...":"Silakan pilih kecamatan dan kelurahan pada profil Anda untuk melihat data tanah."}):e.jsx("div",{className:"text-center text-slate-500 py-8",children:"Memuat data user..."}),e.jsx(p.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.4,delay:.2},children:e.jsx(f,{className:"border-0 shadow-lg overflow-hidden mt-0",children:e.jsxs("div",{className:"relative",children:[e.jsx("div",{style:{position:"absolute",top:16,right:16,zIndex:1e3,display:"flex",flexDirection:"row",gap:8},children:e.jsx("button",{className:`flex items-center gap-1 px-3 py-1 rounded text-xs font-medium border shadow ${l?"bg-gradient-to-r from-blue-700 via-blue-800 to-blue-900 text-white":"bg-gray-200 text-gray-700"}`,onClick:()=>m(a=>!a),title:l?"Sembunyikan Marker":"Tampilkan Marker",style:{minWidth:40},children:l?e.jsx(M,{className:"w-4 h-4"}):e.jsx(E,{className:"w-4 h-4"})})}),e.jsx(w,{className:"p-0 bg-gradient-to-br from-teal-50 to-emerald-50",children:e.jsx($,{tanahList:r,center:j,zoom:13,showMarkers:l})})]})})})]})}export{Q as default};
//# sourceMappingURL=Dashboard-0m9etNmt.js.map
