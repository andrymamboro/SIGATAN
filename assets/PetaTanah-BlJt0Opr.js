import{r as e,j as s,E as a,af as t,ag as r,ah as i,ai as l,aj as n,ak as o,al as d,am as c,R as h,L as m,an as x,ao as p,ap as u,aq as j,u as b,W as g,ar as f}from"./vendor-k34wZweL.js";import{u as y,a as w,g as N}from"./utils-96xLyqgc.js";import{B as v,c as k}from"./index-mO67kouZ.js";import{B as S}from"./badge-DMpao7g-.js";import"./db-JbIjIInw.js";import"./authUser-BiotkqPm.js";import"./pdf-Bn9KpTQO.js";function z({zoom:m=10,mapType:x="hybrid",onMapClick:p,selected:u,isPicker:j,center:b}){const g=y(),{data:f=[],isLoading:k}=w(g),S=f,[z,_]=e.useState(!0),[I,M]=e.useState(!0),[R,$]=e.useState(!0),[D,O]=e.useState(!0),P=`https://mt1.google.com/vt/lyrs=${"hybrid"===x?"y,h":"y"}&x={x}&y={y}&z={z}`,U="hybrid"===x?"Map data ©2025 Google":"&copy; OpenStreetMap contributors";return k?s.jsx("div",{style:{width:"100%",height:400,display:"flex",alignItems:"center",justifyContent:"center"},children:"Memuat data tanah..."}):s.jsxs("div",{style:{width:"100%",height:600,border:"2px solid #e2e8f0",borderRadius:8},children:[s.jsxs("div",{className:"absolute z-[1000] top-20 right-4 flex flex-col-3 gap-2 bg-white bg-opacity-80 p-2 rounded shadow-lg",children:[s.jsx(v,{className:"border border-2 border-white",size:"sm",variant:D?"default":"outline",onClick:()=>O(e=>!e),children:D?s.jsxs(s.Fragment,{children:[s.jsx(a,{className:"w-4 h-4 mr-1"})," Info"]}):s.jsxs(s.Fragment,{children:[s.jsx(t,{className:"w-4 h-4 mr-1"})," Info"]})}),s.jsx(v,{className:"border border-2 border-white",size:"sm",variant:z?"default":"outline",onClick:()=>_(e=>!e),children:z?s.jsxs(s.Fragment,{children:[s.jsx(a,{className:"w-4 h-4 mr-1"})," Marker"]}):s.jsxs(s.Fragment,{children:[s.jsx(t,{className:"w-4 h-4 mr-1"})," Marker"]})})]}),s.jsxs(r,{center:b||[-.78961418,119.89162106],zoom:m,maxZoom:20,style:{width:"100%",height:"100%",borderRadius:8},whenCreated:e=>{p&&e.on("click",p)},children:[s.jsx(i,{url:P,attribution:U,maxZoom:20}),j&&u&&u.latitude&&u.longitude&&s.jsx(l,{position:[u.latitude,u.longitude],children:s.jsxs(n,{children:["Lokasi dipilih: ",u.latitude,", ",u.longitude]})}),S.map((e,a)=>{const t=new URLSearchParams(window.location.search).get("id"),r=parseInt(e.id)===parseInt(t),i=e.latitude&&e.longitude&&z?s.jsxs(l,{position:[e.latitude,e.longitude],children:[s.jsx(n,{children:s.jsx(C,{tanah:e})}),D&&s.jsx(o,{direction:"top",offset:[0,-10],permanent:!0,children:s.jsx("span",{style:{background:r?"#f97316":"#fff",color:r?"#fff":"#000",fontWeight:"bold",borderRadius:6,border:"2px solid #fff",boxShadow:"0 2px 8px #0002",padding:"2px 8px",display:"inline-block"},children:e.nama_pemilik})})]},`marker-${a}`):null;let m=e.polygon_coords;if(m&&"string"==typeof m)try{m=JSON.parse(m)}catch{m=null}const{color:x,borderColor:p}=N(e.status),u=m&&Array.isArray(m)&&m.length>2?s.jsx(d,{positions:m,pathOptions:{color:p,fillColor:x},children:s.jsx(n,{children:s.jsxs("div",{children:[s.jsx("b",{children:"Koordinat Polygon:"}),s.jsx("pre",{style:{fontSize:12,margin:0},children:JSON.stringify(m,null,2)})]})})},`polygon-${a}`):null;let j=e.polyline_coords;if(j&&"string"==typeof j)try{j=JSON.parse(j)}catch{j=null}const b=j&&Array.isArray(j)&&j.length>1?s.jsx(c,{positions:m,color:x.borderColor,fillColor:x.color,fillOpacity:.5,children:s.jsx(n,{children:s.jsxs("div",{children:[s.jsx("b",{children:"Koordinat Polyline:"}),s.jsx("pre",{style:{fontSize:12,margin:0},children:JSON.stringify(j,null,2)})]})})},`polyline-${a}`):null;return s.jsxs(h.Fragment,{children:[i,u,b]},a)})]})]})}function C({tanah:t}){const r=t.luas_meter%1==0?Math.floor(t.luas_meter):t.luas_meter.toString().replace(".",",");return s.jsx(e.Suspense,{fallback:s.jsx("div",{children:"Memuat detail..."}),children:s.jsxs("div",{className:"min-w-[220px] max-w-[260px] bg-white rounded-xl shadow-lg p-4 text-center space-y-3 border border-gray-200",children:[s.jsxs("p",{className:"font-bold text-slate-800 text-base mb-1",children:[t.nama_pemilik,t.nama_penerima&&s.jsxs("span",{className:"block text-xs font-normal text-slate-500",children:["Penerima: ",t.nama_penerima]})]}),s.jsxs("div",{className:"bg-blue-50 py-1 rounded border border-blue-100 font-semibold text-blue-700 text-sm",children:[r," m²"]}),s.jsx("div",{className:"flex justify-center py-1",children:s.jsx("img",{src:`https://api.qrserver.com/v1/create-qr-code/?size=120x120&data=${encodeURIComponent(`https://www.google.com/maps?q=${t.latitude},${t.longitude}`)}`,alt:"QR",className:"w-16 h-16 border rounded shadow"})}),s.jsx(S,{variant:"Selesai"===t.status?"default":"Ditolak"===t.status?"destructive":"secondary",children:t.status||"Proses"}),s.jsx(m,{to:`${k("DetailTanah")}?id=${t.id}`,className:"block mt-2",children:s.jsxs(v,{size:"sm",className:"w-full bg-blue-600 hover:bg-blue-700",children:[s.jsx(a,{className:"w-4 h-4 mr-2"})," Detail"]})})]})})}function _(){const a=b(),t=y(),{data:r=[]}=w(t),i=new URLSearchParams(a.search).get("id");let l;if(i&&r.length>0){const e=r.find(e=>String(e.id)===String(i));e&&e.latitude&&e.longitude&&(l=[Number(e.latitude),Number(e.longitude)])}return s.jsxs("div",{className:"space-y-6 relative",children:[s.jsxs("div",{className:"flex items-center gap-4",children:[s.jsx(m,{to:k("DataTanah"),children:s.jsx(v,{variant:"outline",size:"icon",children:s.jsx(g,{className:"w-4 h-4 text-white"})})}),s.jsx("span",{className:"text-md font-semibold text-white",children:"Ke Data Tanah"}),s.jsxs("div",{className:"flex items-center gap-2 ml-auto",children:[s.jsx("span",{className:"w-4 h-4 border-2 border-white rounded-full bg-blue-500 inline-block"}),s.jsx("span",{className:"text-xs text-white",children:"Proses"}),s.jsx("span",{className:"w-4 h-4 border-2 border-white rounded-full bg-yellow-500 inline-block"}),s.jsx("span",{className:"text-xs text-white",children:"Selesai"}),s.jsx("span",{className:"w-4 h-4 border-2 border-white rounded-full bg-red-500 inline-block"}),s.jsx("span",{className:"text-xs text-white",children:"Ditolak"})]})]}),s.jsx(f.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.1},children:s.jsx(e.Suspense,{fallback:s.jsx("div",{children:"Memuat peta..."}),children:s.jsx(z,{center:l,zoom:l?18:10})})})]})}delete x.Icon.Default.prototype._getIconUrl,x.Icon.Default.mergeOptions({iconRetinaUrl:j,iconUrl:u,shadowUrl:p});export{_ as default};
//# sourceMappingURL=PetaTanah-BlJt0Opr.js.map
