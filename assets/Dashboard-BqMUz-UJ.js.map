{"version":3,"file":"Dashboard-BqMUz-UJ.js","sources":["../../Pages/Dashboard.jsx"],"sourcesContent":["import React from 'react';\r\nimport { useState, useEffect } from 'react';\r\nimport { getCurrentUser } from '@/api/authUser'; // pastikan path benar\r\nimport { useQuery } from '@tanstack/react-query';\r\nimport { supabase } from '@/api/db'; // pastikan path benar\r\nimport { Link } from 'react-router-dom';\r\nimport { Card, CardHeader, CardTitle, CardContent } from '@/components/ui/card';\r\nimport { Button } from '@/components/ui/button';\r\nimport { Map, Users, FileText, BarChart2, User2Icon, Users2, UsersRound } from 'lucide-react';\r\n\r\n\r\nexport default function Dashboard() {\r\n\r\n\r\n  const [user, setUser] = useState(null);\r\n  useEffect(() => {\r\n    // Ambil user gabungan dari helper\r\n    const fetchUser = async () => {\r\n      const user = await getCurrentUser();\r\n      setUser(user);\r\n    };\r\n    fetchUser();\r\n  }, []);\r\n\r\n  // Query total pengguna\r\n  const { data: userCount = 0 } = useQuery({\r\n    queryKey: ['user-count'],\r\n    queryFn: async () => {\r\n      const { count } = await supabase.from('users').select('*', { count: 'exact', head: true });\r\n      return count || 0;\r\n    }\r\n  });\r\n\r\n  // Query total data tanah\r\n  const { data: tanahCount = 0 } = useQuery({\r\n    queryKey: ['tanah-count'],\r\n    queryFn: async () => {\r\n      const { count } = await supabase.from('tanah').select('*', { count: 'exact', head: true });\r\n      return count || 0;\r\n    }\r\n  });\r\n\r\n  // Query total laporan bulan ini\r\n  const { data: laporanCount = 0 } = useQuery({\r\n    queryKey: ['laporan-count'],\r\n    queryFn: async () => {\r\n      const firstDay = new Date();\r\n      firstDay.setDate(1);\r\n      firstDay.setHours(0, 0, 0, 0);\r\n      const { count } = await supabase\r\n        .from('laporan')\r\n        .select('*', { count: 'exact', head: true })\r\n        .gte('created_at', firstDay.toISOString());\r\n      return count || 0;\r\n    }\r\n  });\r\n\r\n  // Query total wilayah\r\n  const { data: wilayahCount = 0 } = useQuery({\r\n    queryKey: ['wilayah-count'],\r\n    queryFn: async () => {\r\n      const { count } = await supabase.from('wilayah').select('*', { count: 'exact', head: true });\r\n      return count || 0;\r\n    }\r\n  });\r\n\r\n  return (\r\n    <div className=\"min-h-screen bg-gradient-to-br from-blue-50 to-blue-100 p-6\">\r\n      <div className=\"max-w-5xl mx-auto\">\r\n        {/* Header */}\r\n         <header className=\"mb-8 flex flex-col md:flex-row md:items-center md:justify-between\">\r\n          <div className=\"flex items-center gap-4\">\r\n            <img src={`${import.meta.env.BASE_URL}img/logo_app.png`} alt=\"Logo\" className=\"h-14 w-auto\" />\r\n            <div>\r\n              <h1 className=\"text-3xl font-bold text-blue-900 mb-2\">SIGATAN Dashboard</h1>\r\n              <p className=\"text-gray-600\">Sistem Informasi Geospasial Pertanahan.</p>\r\n              <p className=\"text-blue-500\" ><User2Icon className=\"w-4 h-4 inline-block mr-1\" />\r\n              {(user && user.full_name ? ` ${user.full_name}` : '') + (user && user.role ? ` (${user.role})` : '')} \r\n              </p>\r\n            </div>\r\n          </div>          <Button asChild className=\"mt-4 md:mt-0\">\r\n            <Link to=\"/PetaTanah\">\r\n              <Map className=\"w-5 h-5 mr-2\" /> Lihat Peta Tanah\r\n            </Link>\r\n          </Button>\r\n        </header>\r\n\r\n        {/* Stats Cards */}\r\n        <div className=\"grid grid-cols-1 md:grid-cols-4 gap-6 mb-8\">\r\n          <Card>\r\n            <CardHeader>\r\n              <CardTitle className=\"flex items-center gap-2 text-blue-700\">\r\n                <Users className=\"w-5 h-5\" /> Pengguna\r\n              </CardTitle>\r\n            </CardHeader>\r\n            <CardContent>\r\n              <div className=\"text-2xl font-bold\">{userCount}</div>\r\n              <div className=\"text-xs text-gray-500\">Total Pengguna</div>\r\n            </CardContent>\r\n          </Card>\r\n          <Card>\r\n            <CardHeader>\r\n              <CardTitle className=\"flex items-center gap-2 text-green-700\">\r\n                <FileText className=\"w-5 h-5\" /> Data Tanah\r\n              </CardTitle>\r\n            </CardHeader>\r\n            <CardContent>\r\n              <div className=\"text-2xl font-bold\">{tanahCount}</div>\r\n              <div className=\"text-xs text-gray-500\">Total Data Tanah</div>\r\n            </CardContent>\r\n          </Card>\r\n          <Card>\r\n            <CardHeader>\r\n              <CardTitle className=\"flex items-center gap-2 text-yellow-700\">\r\n                <BarChart2 className=\"w-5 h-5\" /> Laporan\r\n              </CardTitle>\r\n            </CardHeader>\r\n            <CardContent>\r\n              <div className=\"text-2xl font-bold\">{laporanCount}</div>\r\n              <div className=\"text-xs text-gray-500\">Laporan Bulan Ini</div>\r\n            </CardContent>\r\n          </Card>\r\n          <Card>\r\n            <CardHeader>\r\n              <CardTitle className=\"flex items-center gap-2 text-purple-700\">\r\n                <Map className=\"w-5 h-5\" /> Wilayah\r\n              </CardTitle>\r\n            </CardHeader>\r\n            <CardContent>\r\n              <div className=\"text-2xl font-bold\">{wilayahCount}</div>\r\n              <div className=\"text-xs text-gray-500\">Total Wilayah</div>\r\n            </CardContent>\r\n          </Card>\r\n        </div>\r\n\r\n        {/* Quick Links */}\r\n        <div className=\"grid grid-cols-1 md:grid-cols-3 gap-6\">\r\n          <Link to=\"/DataTanah\">\r\n            <Card className=\"hover:shadow-lg transition\">\r\n              <CardHeader>\r\n                <CardTitle className=\"flex items-center gap-2\">\r\n                  <FileText className=\"w-5 h-5\" /> Data Tanah\r\n                </CardTitle>\r\n              </CardHeader>\r\n              <CardContent>\r\n                <div className=\"text-gray-600\">Kelola dan lihat data pertanahan.</div>\r\n              </CardContent>\r\n            </Card>\r\n          </Link>\r\n          <Link to=\"/Laporan\">\r\n            <Card className=\"hover:shadow-lg transition\">\r\n              <CardHeader>\r\n                <CardTitle className=\"flex items-center gap-2\">\r\n                  <BarChart2 className=\"w-5 h-5\" /> Laporan\r\n                </CardTitle>\r\n              </CardHeader>\r\n              <CardContent>\r\n                <div className=\"text-gray-600\">Buat dan unduh laporan pertanahan.</div>\r\n              </CardContent>\r\n            </Card>\r\n          </Link>\r\n          <Link to=\"/ManajemenUser\">\r\n            <Card className=\"hover:shadow-lg transition\">\r\n              <CardHeader>\r\n                <CardTitle className=\"flex items-center gap-2\">\r\n                  <Users className=\"w-5 h-5\" /> Manajemen User\r\n                </CardTitle>\r\n              </CardHeader>\r\n              <CardContent>\r\n                <div className=\"text-gray-600\">Kelola akun dan hak akses pengguna.</div>\r\n              </CardContent>\r\n            </Card>\r\n          </Link>\r\n        </div>\r\n      </div>\r\n    </div>\r\n  );\r\n}"],"names":["Dashboard","user","setUser","useState","useEffect","async","getCurrentUser","fetchUser","data","userCount","useQuery","queryKey","queryFn","count","supabase","from","select","head","tanahCount","laporanCount","firstDay","Date","setDate","setHours","gte","toISOString","wilayahCount","className","children","jsxs","jsx","src","alt","User2Icon","full_name","role","Button","asChild","Link","to","Map","Card","CardHeader","CardTitle","Users","CardContent","FileText","BarChart2"],"mappings":"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"}